{% extends "base.html" %}

{% load staticfiles %}

{% block title %}{{ post.title }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'blog-detail.css' %}" />
{% endblock %}


{% block content %}

<div class="container">

    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <ol class="breadcrumb">
                <li><a href="{% url 'home:index' %}">首页</a></li>
                <li><a href="{% url 'blog:index' %}">博客</a></li>
                <li class="active">{{ post.title }}</li>
            </ol>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <h1 class="text-center">{{ post.title }}</h1>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <p class="text-right author">
                Published {{ post.publish }} by
                <a href="{% url 'accounts:user' post.author.username %}" target="_blank">
                    {{ post.author.username }}
                </a>
            </p>
        </div>
    </div>
    
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{ post.body|linebreaks }}
        </div>
    </div>

    <div class="row">
        <p>{{ post.viewed }}</p>
        <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 col-md-offset-10">
            <p class="pull-right share">
                <a href="{%  url 'blog:post_share' post.id %}" target="_blank">
                    <button type="button" class="btn btn-success">
                        <span class="glyphicon glyphicon-envelope"></span>
                        分享
                    </button>
                </a>
            </p>
        </div>
    </div>

    <div class="row">
        {% for i in post.tags.all %}
            <span class="glyphicon glyphicon-paperclip">{{ i }}</span>
        {% endfor %}

    </div>

    {% with comments.count as total_comments %}
    
    <div class="row">
        <div class="col-md-2 col-md-offset-10">
            <h3>
                {{ total_comments }} comment{{ total_comments|pluralize }}
            </h3>
        </div>
    </div>
    {% endwith %}

    {% for comment in comments %}

    <div class="row">
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
            <p class="text-info">
                Comment {{ forloop.counter }} by {{ comment.name }}
            </p>
        </div>

        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
            <p class="text-info pull-right">
                {{ comment.created }}
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">
            <p class="comment_body">
                {{ comment.body|linebreaks }}
            </p>
        </div>
    </div>


    {% empty %}

    <p>没有评论</p>

    {% endfor %}



    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <h3>添加评论</h3>
        </div>
    </div>

    <form action="." method="post" class="form-horizonta" role="form">
        {% csrf_token %}
        {% for field in comment_form %}
        <div class="form-group">
            
            {{ field.errors }}
            
            <div class="row">
                <div class="col-md-1 col-lg-1">
                    {{ field.label_tag }}
                </div>
                <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">
                    {{ field }}
                </div> 
            </div>                           
        </div>

        {% endfor %}
    
   
         <button type="submit" class="btn btn-success btn-lg">评论</button>

    </form>


</div>
{% endblock %}